import{c as Nt,_ as Tt,a as St,d as wt,b as _t,e as qe,f as k,g as B,p as Q,h as Et,i as Pt,j as qt,k as It,t as Mt,v as Ie,R as C,l as r,P as i,m as Me,n as Ot,U as Lt,o as kt,q as Oe,I as Bt,r as At,$ as Dt,u as Le,s as R,w as Fe,x as Wt,y as T,z as Ne,A as Gt,B as Ht,C as $t,D as zt,E as Vt,F as Ut,G as Kt,H as Te,J as Yt,K as Jt,L as Qt,S as Xt,M as Zt,N as en,O as tn,Q as nn,T as Se,V as rn}from"./vendor-3z0Gt4wU.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const sn=()=>{try{const e=localStorage.getItem("state");return e?JSON.parse(e):void 0}catch{return}},on=e=>{try{const t=JSON.stringify(e);localStorage.setItem("state",t)}catch{}};function ke(){return Date.now()}const A="db/files/Create",D="db/files/Delete",M="db/files/Import",X="db/files/Update",Z="db/options/setOptionValue",W="ui/layout/app/setEditorMode",Be="ui/layout/app/toggleLeftBar",Ae="ui/layout/app/toggleRightBar",an=e=>e.ui.layout.app.isLeftBarCollapsed,ln=e=>e.ui.layout.app.isRightBarCollapsed,P=e=>e.ui.layout.app.editorMode,S=e=>e.fileManager.selected,cn=e=>e.fileManager.renamed,dn=e=>e.fileManager.defaultTitle,un=Nt(wt,_t),ee=un(e=>Tt(e.db.files.allFiles,({title:t,id:n})=>({title:t,id:n})),e=>St(e,t=>t.title.toLowerCase())),te=(e,t)=>e.db.files.allFiles[t],ne=(e,t,n)=>{const s=e.db.files.allFiles[t];if(s&&(s.options||{})[n])return Object.keys(s.options[n]).length===0?void 0:qe(s.options[n])},De=(e,t)=>{const n=e.db.files.allFiles[t];if(!n)return;const s=n.options||{},o=[];if(s.edit&&o.push({...s.edit}),s.play&&o.push({...s.play}),s.print&&o.push({...s.print}),s.export&&o.push({...s.export}),!!o.length)return o.sort((a,l)=>a.updatedAt-l.updatedAt),o.reduce((a,l)=>Object.assign(a,l),{})},re={edit:["theme","transposeValue","preferredAccidentals","symbolType"],play:["theme","transposeValue","preferredAccidentals","symbolType","chartType","alignChordsWithLyrics","alignBars","autoRepeatChords","expandSectionCopy","columnsCount","fontSize"],print:["transposeValue","preferredAccidentals","symbolType","chartType","alignChordsWithLyrics","alignBars","autoRepeatChords","expandSectionCopy","columnsCount","columnBreakOnSection","documentMargins","fontSize"],export:["chartFormat","transposeValue","preferredAccidentals","symbolType","chartType","alignChordsWithLyrics","alignBars","autoRepeatChords","expandSectionCopy"]},pn={allFiles:{}};function mn(e,t){const{id:n,title:s,content:o}=t.payload,a={...e.allFiles};return a[n]={id:n,title:s,content:o},{...e,allFiles:a}}function hn(e,t){const{id:n,title:s,content:o}=t.payload;if(!s&&typeof o>"u"||!e.allFiles[n])return e;const a={...e.allFiles};return a[n]={...a[n]},s&&(a[n].title=s),typeof o<"u"&&(a[n].content=o),{...e,allFiles:a}}function gn(e,t){const{id:n}=t.payload;if(!n||!e.allFiles[n])return e;const s={...e.allFiles};return delete s[n],{...e,allFiles:s}}function fn(e,t,n){const{context:s,key:o,value:a}=t.payload,l=S(n),c={...e.allFiles};if(["songFormatting","songPreferences"].includes(s)&&c[l]){const d=P(n),u=s==="songPreferences"?"preferences":d;return c[l]=yn(c[l],u,o,a),{...e,allFiles:c}}return e}function yn(e,t,n,s){return{...e,options:{...e.options,[t]:{...(e.options||{})[t],updatedAt:ke(),[n]:s}}}}function bn(e,t,n){const s=S(n),o=t.payload.mode;if(!!!ne(n,s,o)){const l=k(De(n,s)||{},re[o]);if(Object.keys(l).length){l.updatedAt=ke();const c={...e.allFiles};return c[s]={...c[s],options:{...c[s].options,[o]:l}},{...e,allFiles:c}}}return e}const xn=(e=pn,t={},n={})=>{switch(t.type){case A:case M:return mn(e,t);case X:return hn(e,t);case D:return gn(e,t);case Z:return fn(e,t,n);case W:return bn(e,t,n)}return e},se="fileManager/select",We="fileManager/enableRename",p=(e,t,n)=>{if(!(!e.db.options[t]||!e.db.options[t].values||typeof e.db.options[t].values[n]>"u"))return e.db.options[t].values[n]},I=(e,t)=>{if(!(!e.db.options[t]||!e.db.options[t].defaults))return qe(e.db.options[t].defaults)},Cn={};function jn(e,t){const{context:n,key:s,value:o}=t.payload;if(!e[n]||!e[n].values||typeof e[n].values[s]>"u")return e;const a={...e,[n]:{...e[n],values:{...e[n].values}}};return a[n].values[s]=o,a}function Rn(e,t,n){const s=S(n),o=t.payload.mode,a=Ge(n,s,o);return{...e,songFormatting:{...e.songFormatting,values:{...a}}}}function Ge(e,t,n){const s=I(e,"songFormatting");let o=ne(e,t,n);return o||(o=De(e,t)||{}),delete o.updatedAt,o=k(o,re[n]),Object.assign(s,o)}function vn(e,t,n){const{id:s}=t.payload,o=P(n),a=Ge(n,s,o),l=ne(n,s,"preferences")||{};delete l.updatedAt;const c=I(n,"songPreferences"),d=Object.assign(c,l);return{...e,songPreferences:{...e.songPreferences,values:{...d}},songFormatting:{...e.songFormatting,values:{...a}}}}const Fn=(e=Cn,t={},n={})=>{switch(t.type){case Z:return jn(e,t);case W:return Rn(e,t,n);case se:return vn(e,t,n)}return e},Nn=B({files:xn,options:Fn}),Tn={selected:"",renamed:"",defaultTitle:"[untitled]"};function Sn(e=Tn,t={}){switch(t.type){case A:{const{id:n}=t.payload;return{...e,selected:n,renamed:n}}case M:{const{id:n}=t.payload;return{...e,selected:n,renamed:""}}case X:return{...e,renamed:""};case D:return{...e,selected:"",renamed:""};case se:{const{id:n}=t.payload;return{...e,selected:n,renamed:n===e.renamed?n:""}}case We:{const{id:n}=t.payload;return{...e,renamed:n}}}return e}const He="songImporter/import/cancel",ie="songImporter/import/start",$e="songImporter/setContent",ze="songImporter/setInputFormat";function q(e){return Q.sanitize(e,{ALLOWED_TAGS:["#text"],KEEP_CONTENT:!0})}const wn={content:"",isFromWeb:!1,isImporting:!1,inputFormat:"auto",title:""};function _n(e=wn,t={}){switch(t.type){case $e:{const{content:n,title:s=""}=t.payload;return{...e,content:q(n),title:s?q(s):e.title}}case ze:{const{inputFormat:n}=t.payload;return{...e,inputFormat:n}}case M:case He:return{...e,content:"",title:"",isImporting:!1};case ie:{const{content:n,inputFormat:s,title:o,isFromWeb:a}=t.payload;return{...e,isImporting:!0,content:n?q(n):"",title:o?q(o):"",inputFormat:s||e.inputFormat,isFromWeb:a}}}return e}const En={isLeftBarCollapsed:!1,isRightBarCollapsed:!1,editorMode:"edit",activeModal:"none"};function Pn(e=En,t={}){switch(t.type){case Be:return{...e,isLeftBarCollapsed:!e.isLeftBarCollapsed};case Ae:return{...e,isRightBarCollapsed:!e.isRightBarCollapsed};case W:{const{mode:n}=t.payload;return{...e,editorMode:n}}case D:case A:case M:return{...e,editorMode:"edit"}}return e}const qn=B({app:Pn}),In=B({layout:qn}),Mn=B({db:Nn,fileManager:Sn,songImporter:_n,ui:In}),On={editorPreferences:{values:{theme:"dark1",chartFormat:"chordmark"},defaults:{theme:"dark1",chartFormat:"chordmark"}},songPreferences:{values:{transposeValue:0,preferredAccidentals:"auto",symbolType:"chord"},defaults:{transposeValue:0,preferredAccidentals:"auto",symbolType:"chord"}},songFormatting:{values:{chartType:"all",alignChordsWithLyrics:!0,alignBars:!0,autoRepeatChords:!0,expandSectionCopy:!0,fontSize:0,columnsCount:1,columnBreakOnSection:!0,documentMargins:3},defaults:{chartType:"all",alignChordsWithLyrics:!0,alignBars:!0,autoRepeatChords:!0,expandSectionCopy:!0,fontSize:0,columnsCount:1,columnBreakOnSection:!0,documentMargins:3}}},Ln={options:On},kn={db:Ln};let L;function Bn(){const e=Et(Pt(Mt)),t=sn();t&&t.db&&t.db.options&&delete t.db.options.rendering;const n=qt(t,kn);L=It(Mn,n,e),L.subscribe(()=>{on(L.getState())})}function G(){return L}function v(e,t){if(!e)throw new TypeError("Cannot create an action without an action type");return{type:e,payload:t}}const An=(e,t)=>v($e,{content:e,title:t}),Dn=e=>v(ze,{inputFormat:e}),Wn=()=>v(ie,{isFromWeb:!1}),Gn=(e,t,n)=>v(ie,{content:t,inputFormat:e,title:n,isFromWeb:!0}),Hn=()=>v(He),$n={"@CCS/IMPORT_TAB":e=>{const t=G(),n=zn(e.title,e.artist);t.dispatch(Gn(e.inputFormat,e.chordChart,n))}},zn=(e,t)=>"_"+(t?t+" - ":"")+e;function Vn(){return $n}function Un(){window.addEventListener("message",Kn)}const Kn=e=>{const t={...Vn()};if(e.source!==window||e.origin!==window.location.origin)return!1;const n=e.data;return typeof t[n.type]=="function"&&t[n.type](n.payload),!0},Yn=(e,t="")=>{if(!e)throw new TypeError("Cannot create a file without title");const n={id:Ie(),title:e,content:t};return v(A,n)},K=(e,t="")=>{if(!e)throw new TypeError("Cannot import a file without title");const n={id:Ie(),title:e,content:t};return v(M,n)},Ve=(e,{title:t,content:n}={})=>{if(!e)throw new TypeError("Cannot update a file without an id");return v(X,{id:e,title:t,content:n})},Jn=e=>v(D,{id:e}),Qn=`Welcome to Chord Chart Studio!

Chord Chart Studio is the official editor of the ChordMark format. 
You can use it to quickly write accurate transcription of songs made up of chords and lyrics. 

A % D7.. E7..
_Just write _some chords, some _lyrics
%
_And see how it _looks: _terrific!

Where to start? You can either:
- check the sample song on the left
- read the user guide, by clicking the big yellow button in the top right corner

Have fun! 
`,Xn=`#i
C.. Am.. %
%

#v
C.. Am..
I _heard there was a _secret chord
%
That _David played and it _pleased the lord
F... G. C.. G..
But _you don't really care for _music, _do you?
C.. F. G.
Well it _goes like this the _fourth, the _fifth
Am.. F..
The _minor fall and the _major lift
G.. E7.. Am
The _baffled king com_posing halle_lujah

#c
F
Halle_lujah
Am
Halle_lujah
F
Halle_lujah
C.. G.. C.. Am..
Halle_lu_u_jah

#v
Well, your _faith was strong but you _needed proof
You _saw her bathing _on the roof
Her _beauty and the moonlight _over_threw you
She _tied you to her _kitchen _chair
She _broke your throne and she _cut your hair
And _from your lips she _drew the halle_lujah

#c
`;function Zn(){const e=G(),t=e.getState();ee(t).length===0&&(e.dispatch(K("Hallelujah - Leonard Cohen",Xn)),e.dispatch(K("Getting started",Qn)))}class Ue extends C.Component{constructor(t){super(t),this.state={error:null,errorInfo:null}}componentDidCatch(t,n){this.setState({error:t,errorInfo:n})}render(){return this.state.errorInfo?r.jsxs("div",{className:"ErrorBoundary",children:[r.jsx("h2",{children:"Something went wrong"}),r.jsxs("details",{style:{whiteSpace:"pre-wrap"},open:!0,children:[this.state.error&&this.state.error.toString(),r.jsx("br",{}),this.state.errorInfo.componentStack]})]}):this.props.children}}Ue.propTypes={children:i.any};let V;function er(e,t){const n=document.getElementById("app");V||(V=Me(n)),V.render(r.jsx(Ot,{store:G(),children:r.jsx(C.StrictMode,{children:r.jsx(Ue,{children:r.jsx(e,{...t})})})}))}var tr={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const nr={base:tr.VITE_BASE||""};let Y,Ke;const rr={init(e){const t=e.map(n=>({...n,path:nr.base+n.path,action:s=>({Controller:n.action,params:s.params})}));Y=new Lt(t,{errorHandler(n,s){console.error(`Error: Cannot find route for path: ${s.pathname}`)}}),Ke=kt(Y,{stringifyQueryParams:Oe.stringify})}};function H(e,t=!0){const n=new URL(e,window.location.origin);return Y.resolve(n.pathname).then(({Controller:s,params:o}={})=>{if(s){t&&sr(e);const a=Oe.parse(n.search,{ignoreQueryPrefix:!0});er(s,{...o,...a})}})}function Ye(e,t){try{return Ke(e,t)}catch(n){console.error(n.toString())}}function sr(e){window.history.pushState({url:e},null,e)}window.addEventListener("popstate",()=>{const e=window.location.pathname+window.location.search;H(e,!1)});const ir="_button_18d4b_1",or="_icon_18d4b_8",ar="_label_18d4b_8",lr="_primary_18d4b_41",cr="_secondary_18d4b_58",dr="_tertiary_18d4b_76",E={button:ir,icon:or,label:ar,primary:lr,secondary:cr,tertiary:dr};function ur({id:e,size:t}){let n;switch(e){case"plus":n=At;break;case"import":n=Bt;break}return r.jsx(n,{size:t})}const we="primary";function pr({children:e,type:t=we,icon:n="",onPress:s}){const o=[E.button,E[t]?E[t]:E[we]],a=n?r.jsx("span",{className:E.icon,children:r.jsx(ur,{id:n,size:20})}):"";return r.jsxs(Dt,{onPress:s,className:o.join(" "),children:[a,r.jsx("span",{className:E.label,children:e})]})}function mr(){const t=Le(ee).map(n=>r.jsx(hr,{song:n},n.id));return r.jsxs("div",{children:["Full Library",r.jsx("ul",{children:t}),r.jsx(pr,{children:"My Nice Button"})]})}const hr=({song:e})=>{const t=n=>{n.preventDefault(),H(Ye("songView",{songId:e.id}))};return r.jsx("li",{children:r.jsx("a",{href:`/song/${e.id}`,onClick:t,children:e.title})})},gr=[{name:"library",path:"/library",action:mr}];function fr({songId:e}){const t=Le(s=>te(s,e)),n=s=>{s.preventDefault(),H(Ye("library"))};return r.jsxs("div",{children:[r.jsx("a",{href:"",onClick:n,children:"Go back to list"}),r.jsx("br",{}),r.jsx("b",{children:t.title}),r.jsx("p",{children:t.content})]})}const yr=[{name:"songView",path:"/songView/:songId",action:fr}],Je=e=>v(W,{mode:e}),br=()=>v(Be),xr=()=>v(Ae),Cr="/assets/logo-D2B3txiq.svg";function jr(){return r.jsx("div",{className:"logo",children:r.jsx("div",{className:"logo-isExpanded",children:r.jsx("div",{className:"logo-img",children:r.jsxs("svg",{className:"stacked",children:[r.jsx("title",{children:"Chord Chart Studio"}),r.jsx("use",{href:Cr+"#stacked"})]})})})})}const Rr=C.memo(jr);function Qe(e){const{iconName:t}=e,n=["icon","material-icons"];return r.jsx("i",{className:n.join(" "),children:t})}Qe.propTypes={iconName:i.string.isRequired};const x=C.memo(Qe);function Xe(e){const{label:t,icon:n,editorMode:s,setEditorMode:o,isActive:a,isDisabled:l}=e,c=["mainNavEntry"];a&&c.push("mainNavEntry-isActive"),l&&c.push("mainNavEntry-isDisabled");function d(){l||o(s)}return r.jsxs("li",{className:c.join(" "),onClick:d,children:[r.jsx("span",{className:"mainNavEntry-icon",children:r.jsx(x,{iconName:n})}),t]})}Xe.propTypes={label:i.string.isRequired,icon:i.string.isRequired,editorMode:i.string.isRequired,setEditorMode:i.func.isRequired,isActive:i.bool.isRequired,isDisabled:i.bool.isRequired};const vr=C.memo(Xe);function Ze(e){const{currentMode:t,allEntries:n,setEditorMode:s,selectedId:o}=e;return r.jsx("nav",{className:"mainNav",children:r.jsx("ul",{className:"mainNav-entries",children:n.map((a,l)=>r.jsx(vr,{isActive:!!o&&a.editorMode===t,isDisabled:!o,setEditorMode:s,...a},l))})})}Ze.propTypes={currentMode:i.string.isRequired,setEditorMode:i.func.isRequired,selectedId:i.string,allEntries:i.arrayOf(i.shape({id:i.string.isRequired,label:i.string.isRequired,icon:i.string.isRequired,editorMode:i.string.isRequired}))};const Fr=C.memo(Ze),_=({children:e,isDisabled:t,buttonName:n,onClick:s,type:o})=>{const a=["Button"];return o==="primary"&&a.push("Button-primary"),o==="secondary"&&a.push("Button-secondary"),t&&a.push("Button-isDisabled"),r.jsx("button",{className:a.join(" "),disabled:t,type:"button",name:n,onClick:s,children:e})};_.propTypes={children:i.string.isRequired,isDisabled:i.bool,buttonName:i.string.isRequired,type:i.string.isRequired,onClick:i.func.isRequired};_.defaultProps={isDisabled:!1};const Nr="https://chord-chart-studio.netlify.app",oe=()=>{const e=()=>{window.open(Nr,"_blank").focus()};return r.jsxs("div",{className:"userGuide",children:[r.jsx("div",{className:"userGuide-isCollapsed",children:r.jsx(x,{iconName:"help_outline"})}),r.jsx("div",{className:"userGuide-isExpanded",children:r.jsx(_,{buttonName:"userGuide",type:"primary",onClick:e,children:"User Guide"})})]})};oe.propTypes={};oe.defaultProps={};const Tr=C.memo(oe),Sr=()=>({"chord-chart-studio":"v0.14.0","chord-symbol":"v4.0.0","chord-mark":"v0.16.2"});function wr(){const e=Sr();return r.jsx("div",{className:"versions",children:r.jsxs("div",{className:"versions-isExpanded",children:["Chord Chart Studio ",e["chord-chart-studio"],r.jsx("br",{}),"ChordSymbol ",e["chord-symbol"]," ",r.jsx("br",{}),"ChordMark ",e["chord-mark"]," ",r.jsx("br",{}),"Logo by"," ",r.jsx("a",{href:"https://spelling-bee-assistant.app/",target:"_blank",rel:"noreferrer",children:"Dieter Raber"})]})})}const _r=C.memo(wr),Er=e=>e.songImporter.content,Pr=e=>e.songImporter.inputFormat,qr=e=>e.songImporter.title,Ir=e=>e.songImporter.isImporting,Mr=e=>e.songImporter.isFromWeb;function ae(e){const{children:t,closeModal:n}=e;return R.useEffect(()=>{const s=o=>{o.key==="Escape"&&n()};return window.addEventListener("keyup",s),()=>{window.removeEventListener("keyup",s)}}),r.jsxs("section",{className:"mod-ModalContainer",children:[r.jsx("div",{className:"mod-Overlay",onClick:n,"data-testid":"modal-overlay"}),r.jsx("div",{className:"mod-ContentContainer",children:t})]})}ae.propTypes={children:i.element.isRequired,closeModal:i.func.isRequired};const et=({cancelImport:e,chordMarkContent:t,importFile:n,title:s,content:o,error:a})=>{const l=s?'Import "'+s+'"':"Import song",c=()=>{n(s||"[untitled]",t)};return r.jsxs("div",{className:"sim-Header_Container",children:[r.jsx("div",{className:"sim-Header_Title",children:l}),r.jsxs("div",{className:"sim-Header_Actions",children:[r.jsx(_,{onClick:e,buttonName:"cancel",type:"secondary",children:"CANCEL"}),r.jsx(_,{onClick:c,buttonName:"import",type:"primary",isDisabled:o===""||a!=="",children:"IMPORT"})]})]})};et.propTypes={cancelImport:i.func.isRequired,chordMarkContent:i.string,content:i.string,error:i.string,importFile:i.func.isRequired,title:i.string};const tt=50*1024,Or=e=>new Promise((t,n)=>{if(e.length){const s=e[0];kr(s)?n(Ar(s.size)):Br(s)?s.text().then(o=>{t({content:o,title:Lr(s)})}).catch(o=>{n(o)}):n(Dr(s))}else n(Wr())}),Lr=e=>e.name.substr(0,e.name.lastIndexOf(".")),kr=e=>e.size>tt,Br=e=>e.type.indexOf("text")===0||e.type.length===0,Ar=e=>"The selected file is too big: "+Fe(e,{round:0})+" (maximum allowed file size is "+Fe(tt,{round:0})+").",Dr=e=>"Cannot import file of type "+e.type+".",Wr=()=>"No file selected.",Gr="text/*,.cho,.crd,.chopro,.chord,.pro,.txt,.md",nt=({setContent:e})=>{const t=n=>{Or(n.target.files).then(s=>{e(s.content,s.title)}).catch(s=>{e(s)})};return r.jsxs("div",{children:[r.jsx("label",{htmlFor:"importSong-Input",className:"Button Button-primary",children:"Select File"}),r.jsx("input",{id:"importSong-Input",name:"importSong-Input",type:"file",className:"sim-InputFile_Input",onChange:t,accept:Gr})]})};nt.propTypes={setContent:i.func.isRequired};function le(e){const{content:t,setContent:n,isDisabled:s}=e,o=l=>{n(l.target.value)},a=["sim-Input_Textarea"];return s&&a.push("sim-Input_Textarea-Disabled"),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"sim-Input_Header",children:[r.jsx(x,{iconName:"arrow_drop_down"}),"Copy/paste below",r.jsx(x,{iconName:"arrow_drop_down"})]}),r.jsx("textarea",{className:a.join(" "),onChange:o,value:t,disabled:s,"data-testid":"sim-input"})]})}le.propTypes={content:i.string.isRequired,isDisabled:i.bool.isRequired,setContent:i.func.isRequired};le.defaultProps={};function ce(e){const{inputFormat:t,error:n}=e;return r.jsxs("div",{className:"sim-Preview_Error",children:[r.jsxs("p",{children:["There was an error when trying to parse the song in the specified input format (",t,").",r.jsx("br",{}),"Please correct the input or try another format.",r.jsx("br",{}),"The error was:"]}),r.jsxs("p",{children:['"',n,'"']}),r.jsx("p",{children:'Hint: most of the time, this is related to an unclosed "[" or "{" or an unsupported ChordPro directive'})]})}ce.propTypes={error:i.string,inputFormat:i.string.isRequired};ce.defaultProps={};function de(e){const{setInputFormat:t,inputFormat:n,id:s,label:o,isDisabled:a}=e,l=u=>{a||t(u.target.value)},c=["sim-InputFormat_Entry"],d=["sim-InputFormat_Label"];return a&&(c.push("sim-InputFormat_Entry-Disabled"),d.push("sim-InputFormat_Label-Disabled")),r.jsxs(r.Fragment,{children:[r.jsx("input",{className:c.join(" "),type:"radio",name:"inputFormat",id:s,value:s,onChange:l,checked:n===s}),r.jsx("label",{className:d.join(" "),htmlFor:s,children:o})]})}de.propTypes={setInputFormat:i.func.isRequired,inputFormat:i.string.isRequired,id:i.string.isRequired,label:i.string.isRequired,isDisabled:i.bool.isRequired};de.defaultProps={};const Hr=[{id:"auto",label:"Detect"},{id:"chordPro",label:"Bracketed chords (ChordPro)"},{id:"chordsOverLyrics",label:"Chords over lyrics (Ultimate Guitar...)"}];function ue(e){const{setInputFormat:t,inputFormat:n,disableAll:s}=e,o=Hr.map(a=>r.jsx(de,{setInputFormat:t,id:a.id,label:a.label,inputFormat:n,isDisabled:s},a.id));return r.jsxs("div",{className:"sim-InputFormat",children:["Input format:",o]})}ue.propTypes={disableAll:i.bool.isRequired,setInputFormat:i.func.isRequired,inputFormat:i.string.isRequired};ue.defaultProps={};function pe(e){const{cancelImport:t,content:n,importFile:s,isFromWeb:o,isImporting:a,setContent:l,setInputFormat:c,inputFormat:d,title:u}=e;if(!a)return null;let h="",m="";try{h=Wt(n,{inputFormat:d})}catch(f){m=f.message}return r.jsx(ae,{closeModal:t,children:r.jsxs("div",{className:"sim-SongImporterModal_Container","data-testid":"song-importer",children:[r.jsx(et,{cancelImport:t,chordMarkContent:h,content:n,error:m,importFile:s,title:u}),r.jsxs("div",{className:"sim-TwoColumns_Container",children:[r.jsx("div",{className:"sim-Column_Container",children:r.jsx(nt,{setContent:l})}),r.jsx("div",{className:"sim-Column_Container",children:r.jsx(ue,{inputFormat:d,setInputFormat:c,disableAll:o===!0})})]}),r.jsxs("div",{className:"sim-TwoColumns_Container sim-TwoColumns_Container-autoHeight",children:[r.jsx("div",{className:"sim-Column_Container",children:r.jsx(le,{content:n,setContent:l,isDisabled:o})}),r.jsxs("div",{className:"sim-Column_Container",children:[r.jsxs("div",{className:"sim-Input_Header",children:[r.jsx(x,{iconName:"arrow_drop_down"}),"ChordMark preview",r.jsx(x,{iconName:"arrow_drop_down"})]}),r.jsx("div",{className:"sim-Preview_Container","data-testid":"sim-preview",children:m?r.jsx(ce,{inputFormat:d,error:m}):h})]})]})]})})}pe.propTypes={cancelImport:i.func.isRequired,content:i.string.isRequired,importFile:i.func.isRequired,isFromWeb:i.bool.isRequired,isImporting:i.bool.isRequired,setContent:i.func.isRequired,setInputFormat:i.func.isRequired,inputFormat:i.string.isRequired,title:i.string};pe.defaultProps={};const $r=T(e=>({content:Er(e),isFromWeb:Mr(e),isImporting:Ir(e),inputFormat:Pr(e),title:qr(e)}),{setContent:An,setInputFormat:Dn,cancelImport:Hn,importFile:K})(pe),zr=[{id:"edit",label:"Edit",icon:"create",editorMode:"edit"},{id:"play",label:"Screen view",icon:"music_note",editorMode:"play"},{id:"print",label:"Print/PDF Preview",icon:"print",editorMode:"print"},{id:"export",label:"Export Preview",icon:"save_alt",editorMode:"export"}];function me(e){const{editorMode:t,isLeftBarCollapsed:n,isRightBarCollapsed:s,toggleLeftBar:o,toggleRightBar:a,setEditorMode:l,selectedId:c,leftBar:d,rightBar:u}=e,h=["leftBar"];n&&h.push("leftBar-isCollapsed");const m=["rightBar"];return s&&m.push("rightBar-isCollapsed"),r.jsxs("div",{className:"appLayout-wrapper",children:[r.jsx($r,{}),r.jsxs("section",{className:h.join(" "),children:[r.jsxs("div",{className:"leftBar-content",onClick:n?o:null,children:[r.jsx(Rr,{}),d]}),r.jsx("div",{className:"leftBar-collapser",onClick:o,"data-testid":"leftBar-collapser",children:r.jsx("span",{className:"leftBar-collapserIcon",children:r.jsx(x,{iconName:"keyboard_arrow_left"})})})]}),r.jsxs("section",{className:"appLayout-main",children:[r.jsx("section",{className:"appLayout-header",children:r.jsx(Fr,{allEntries:zr,currentMode:t,setEditorMode:l,selectedId:c})}),r.jsx("section",{className:"appLayout-content",children:e.children})]}),r.jsxs("section",{className:m.join(" "),children:[r.jsx("div",{className:"rightBar-collapser",onClick:a,"data-testid":"rightBar-collapser",children:r.jsx("span",{className:"rightBar-collapserIcon",children:r.jsx(x,{iconName:"keyboard_arrow_right"})})}),r.jsxs("div",{className:"rightBar-content",onClick:s?a:null,children:[r.jsx(Tr,{}),u,r.jsx(_r,{})]})]})]})}me.propTypes={children:i.element,isLeftBarCollapsed:i.bool,isRightBarCollapsed:i.bool,selectedId:i.string,toggleLeftBar:i.func.isRequired,toggleRightBar:i.func.isRequired,editorMode:i.string.isRequired,setEditorMode:i.func.isRequired,leftBar:i.element.isRequired,rightBar:i.element.isRequired};me.defaultProps={isLeftBarCollapsed:!1,isRightBarCollapsed:!1};const Vr=T(e=>({editorMode:P(e),isLeftBarCollapsed:an(e),isRightBarCollapsed:ln(e),selectedId:S(e)}),{toggleLeftBar:br,toggleRightBar:xr,setEditorMode:Je})(me),Ur=e=>v(se,{id:e}),Kr=e=>v(We,{id:e});function Yr(e,t={},n=!1){return st(e,t,n,"text")}function rt(e,t={},n=!1){return st(e,t,n,"html")}function st(e,t,n,s){if(n)switch(t.chartFormat){case"chordmark":{const a=O(e,t);return s==="html"?a:_e(a)}case"chordmarkSrc":return s==="html"?U(e):e;case"chordpro":{t.customRenderer=$t();const a=O(e,t);return s==="html"?U(a):a}case"ultimateGuitar":{t.customRenderer=Ne();const a=O(e,{...t,customRenderer:Ne(),printBarSeparators:"grids",printChordsDuration:"never",printSubBeatDelimiters:!1,printInlineTimeSignatures:!1,chordSymbolRenderer:Gt({customFilters:[Ht()],useShortNamings:!0,accidentalsType:t.accidentalsType==="auto"?"original":t.accidentalsType,...t})})+`

Created with Chord Chart Studio (https://chord-chart-studio.netlify.app)`;return s==="html"?U(a):a}}const o=O(e,{...t,wrapChordLyricLines:!0});return s==="html"?o:_e(o)}function O(e,t){try{const n=zt(e);return Vt(n,{...t})}catch(n){return n.message}}function U(e){return e.split(`
`).map(t=>t===""?"&nbsp;":t).map(t=>`<span class="txtLine">${t}</span>`).join("")}function _e(e){return e.match(/(<p.*?>.*?<\/p>)/gm).map(n=>q(n)).map(n=>n==="&nbsp;"?"":n).join(`
`)}function Jr(){const t=G().getState(),n=S(t),s=te(t,n),o={chartFormat:p(t,"editorPreferences","chartFormat"),transposeValue:p(t,"songPreferences","transposeValue"),accidentalsType:p(t,"songPreferences","accidentalsType"),symbolType:p(t,"songPreferences","symbolType"),chartType:p(t,"songFormatting","chartType"),alignChordsWithLyrics:p(t,"songFormatting","alignChordsWithLyrics"),alignBars:p(t,"songFormatting","alignBars"),autoRepeatChords:p(t,"songFormatting","autoRepeatChords"),expandSectionCopy:p(t,"songFormatting","expandSectionCopy")},a=Yr(s.content,o,!0),l=o.chartFormat==="chordpro"?"cho":"txt",c=`${s.title}.${l}`,d=new Blob([a],{type:"text/plain;charset=utf-8",endings:"native"});Ut.saveAs(d,c)}function it(e){const{confirmAction:t,confirmTitle:n="OK",cancelAction:s,cancelTitle:o="CANCEL",children:a}=e;return r.jsx(ae,{closeModal:s,children:r.jsxs("section",{className:"mod-ModalConfirmContainer",children:[r.jsx("div",{className:"mod-ModalConfirmMessage",children:a}),r.jsxs("div",{className:"mod-ModalConfirmButtons",children:[r.jsx(_,{onClick:s,type:"secondary",buttonName:"cancel",children:o}),r.jsx(_,{onClick:t,type:"primary",buttonName:"confirm",children:n})]})]})})}it.propTypes={confirmAction:i.func.isRequired,confirmTitle:i.string,cancelAction:i.func.isRequired,cancelTitle:i.string,children:i.node.isRequired};function ot(e){const{selected:t,deleteFile:n,isDeleting:s,setIsDeleting:o}=e;if(!s)return null;const a=()=>o(!1),l=()=>{o(!1),n(t)};return r.jsxs(it,{confirmAction:l,confirmTitle:"DELETE",cancelAction:a,children:["Are you sure you want to delete this file?",r.jsx("br",{}),"This action cannot be undone."]})}ot.propTypes={deleteFile:i.func.isRequired,isDeleting:i.bool.isRequired,selected:i.string.isRequired,setIsDeleting:i.func.isRequired};function at(e){const{icon:t,text:n,action:s,isDisabled:o}=e,a=["fileManagerAction"];o&&a.push("fileManagerAction-isDisabled");const l=()=>{o||s()};return r.jsx("span",{className:a.join(" "),onClick:l,children:r.jsxs("span",{className:"fileManagerAction-icon",children:[r.jsx(x,{iconName:t})," ",n]})})}at.propTypes={icon:i.string.isRequired,text:i.string.isRequired,action:i.func.isRequired,isDisabled:i.bool.isRequired};const Qr=C.memo(at);function lt(e){const{selected:t,createFile:n,deleteFile:s,enableRename:o,startImport:a,exportAsText:l,printFile:c}=e,d=[{icon:"upload",text:"Import",action:a,isDisabled:!1},{icon:"add_circle",text:"New",action:n,isDisabled:!1},{icon:"create",text:"Rename",action:o,isDisabled:!t},{icon:"delete",text:"Delete",action:s,isDisabled:!t},{icon:"print",text:"Print",action:c,isDisabled:!t},{icon:"download",text:"Export",action:l,isDisabled:!t}];return r.jsx("div",{className:"fileManager-actionsList",children:d.map((u,h)=>R.createElement(Qr,{...u,key:h}))})}lt.propTypes={selected:i.string,createFile:i.func.isRequired,deleteFile:i.func.isRequired,enableRename:i.func.isRequired,exportAsText:i.func.isRequired,printFile:i.func.isRequired,startImport:i.func.isRequired};const Xr=C.memo(lt);function ct(e){const[t,n]=R.useState(e.title),{fileId:s,isSelected:o,isRenamed:a,defaultTitle:l,selectFile:c,enableRename:d,updateFile:u}=e,h=["fileManagerEntry"];o&&h.push("fileManagerEntry-isSelected"),a&&h.push("fileManagerEntry-isRenamed");const m=C.createRef();R.useEffect(()=>{a&&m.current.focus()},[a,m]);function f(){o||c(s)}function g(b){a||(d(s),b.target.select())}function y(b){if(a&&b.which===13){b.preventDefault(),window.getSelection().removeAllRanges();const z=b.target.value;j(z)}}function w(b){n(b.target.value)}function N(b){a&&b.target.select()}function F(b){if(a){const z=b.target.value;j(z)}}function j(b){b=b||l,u(s,{title:b}),n(b),m.current.scrollLeft=0}return r.jsx("li",{className:h.join(" "),onClick:f,onDoubleClick:g,children:r.jsx("input",{className:"fileManagerEntry-input",ref:m,type:"text",value:t,readOnly:a?null:"readOnly",autoFocus:a?"autoFocus":null,onChange:w,onBlur:F,onFocus:N,onKeyPress:y})})}ct.propTypes={title:i.string.isRequired,fileId:i.string.isRequired,isSelected:i.bool.isRequired,isRenamed:i.bool.isRequired,defaultTitle:i.string.isRequired,selectFile:i.func.isRequired,enableRename:i.func.isRequired,updateFile:i.func.isRequired};function dt(e){const[t,n]=R.useState(!1),{allTitles:s,selected:o,renamed:a,defaultTitle:l,createFile:c,deleteFile:d,enableRename:u,startImport:h,selectFile:m,updateFile:f,setEditorMode:g}=e;return r.jsxs("div",{className:"fileManager",children:[r.jsx(ot,{deleteFile:d,isDeleting:t,selected:o,setIsDeleting:n}),r.jsx("div",{className:"fileManager-isCollapsed",children:r.jsx("span",{className:"fileManager-icon",children:r.jsx(x,{iconName:"file_copy"})})}),r.jsxs("div",{className:"fileManager-isExpanded",children:[r.jsx(Xr,{selected:o,createFile:()=>c(l),deleteFile:()=>n(!0),enableRename:()=>u(o),startImport:()=>h(),exportAsText:()=>{g("export"),setTimeout(()=>Jr(),0)},printFile:()=>{g("print"),setTimeout(()=>window.print(),0)}}),r.jsx("ul",{className:"fileManager-entriesList",children:s.map(y=>r.jsx(ct,{title:y.title,defaultTitle:l,fileId:y.id,isSelected:o===y.id,isRenamed:a===y.id,selectFile:m,updateFile:f,enableRename:u},y.id))})]})]})}dt.propTypes={allTitles:i.arrayOf(i.shape({title:i.string.isRequired,id:i.string.isRequired})).isRequired,selected:i.string.isRequired,renamed:i.string.isRequired,defaultTitle:i.string.isRequired,selectFile:i.func.isRequired,createFile:i.func.isRequired,deleteFile:i.func.isRequired,enableRename:i.func.isRequired,startImport:i.func.isRequired,updateFile:i.func.isRequired,setEditorMode:i.func.isRequired};const Zr=T(e=>({selected:S(e),renamed:cn(e),defaultTitle:dn(e),allTitles:ee(e)}),{selectFile:Ur,createFile:Yn,deleteFile:Jn,updateFile:Ve,enableRename:Kr,setEditorMode:Je,startImport:Wn})(dt);function ut(e){return Q.sanitize(e)}function he(e){const{content:t,useChartFormat:n}=e,s=k(e,["chartFormat","transposeValue","accidentalsType","symbolType","chartType","alignChordsWithLyrics","alignBars","autoRepeatChords","expandSectionCopy"]),o=rt(t,s,n);return r.jsx("div",{className:"songRenderer",children:r.jsx("div",{dangerouslySetInnerHTML:{__html:ut(o)}})})}he.propTypes={useChartFormat:i.bool.isRequired,chartFormat:i.string.isRequired,content:i.string};he.defaultProps={content:"",useChartFormat:!1};const ge=T(e=>({transposeValue:p(e,"songPreferences","transposeValue"),accidentalsType:p(e,"songPreferences","preferredAccidentals"),symbolType:p(e,"songPreferences","symbolType"),chartFormat:p(e,"editorPreferences","chartFormat"),chartType:p(e,"songFormatting","chartType"),alignChordsWithLyrics:p(e,"songFormatting","alignChordsWithLyrics"),alignBars:p(e,"songFormatting","alignBars"),autoRepeatChords:p(e,"songFormatting","autoRepeatChords"),expandSectionCopy:p(e,"songFormatting","expandSectionCopy")}))(he);function pt(e){const{selectedFile:t}=e,n=["editorPreview"];return r.jsx("div",{className:n.join(" "),children:r.jsx(ge,{content:t.content})})}pt.propTypes={selectedFile:i.object.isRequired};function es(){return[Kt(),Te({"Mod-z":Yt,"Mod-y":Jt}),Te(Qt)]}const ts=new Xt({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return["br"]}},text:{group:"inline"}}});function ns(e){return e.toJSON().doc.content.map(n=>n.content?n.content.reduce((s,o)=>(s+=o.text||`
`,s),""):"").join(`
`)}function Ee(e){const t={ALLOWED_TAGS:["p","#text"],KEEP_CONTENT:!1};return Q.sanitize(e,t)}function rs(e){const t=Ee(e).split(`
`).map(s=>`<p>${s}</p>`).join(""),n=document.createElement("div");return n.innerHTML=Ee(t),n}function ss(e){return Zt.create({doc:en.fromSchema(ts).parse(rs(e),{preserveWhitespace:"full"}),plugins:es()})}function is(e,t,n){return new tn(null,{state:e,dispatchTransaction:function(o){const{state:a,transactions:l}=this.state.applyTransaction(o);this.updateState(a),l.some(c=>c.docChanged)&&t(n,{content:ns(a)})}})}function $(e){const{selectedFileId:t,editorContent:n,updateFile:s}=e,o=R.useRef(),a=R.useRef(),l=os(t);function c(){return t&&(!o.current||l!==t)}function d(){return u()&&!t}function u(){return o.current&&o.current.dom.parentNode}function h(){o.current.dom.parentNode.removeChild(o.current.dom)}return R.useEffect(()=>{if(c()){u()&&h();const m=ss(n);o.current=is(m,s,t),a.current.appendChild(o.current.dom),$.editorView=o.current}else d()&&h()}),r.jsx("div",{className:"prosemirrorWrapper",ref:a})}$.defaultProps={selectedFileId:"",editorContent:""};$.propTypes={selectedFileId:i.string,editorContent:i.string,updateFile:i.func.isRequired};function os(e){const t=R.useRef();return R.useEffect(()=>{t.current=e}),t.current}function mt(e){const{selectedFile:t,updateFile:n,theme:s}=e,o=["songEditor-preview","cmTheme-"+s,"cmTheme-fadeRepeats"];return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"songEditor-headers",children:[r.jsxs("div",{className:"songEditor-sourceHeader",children:[r.jsx(x,{iconName:"arrow_drop_down"}),"ChordMark source (",r.jsx("a",{href:"https://chordmark.netlify.app/docs/getting-started",target:"_blank",rel:"noreferrer",className:"link1",children:"tutorial"}),")",r.jsx(x,{iconName:"arrow_drop_down"})]}),r.jsxs("div",{className:"songEditor-previewHeader",children:[r.jsx(x,{iconName:"arrow_drop_down"}),"Result preview",r.jsx(x,{iconName:"arrow_drop_down"})]})]}),r.jsx(nn,{children:r.jsxs("div",{className:"songEditor",children:[r.jsx(Se,{group:"a",children:r.jsx("div",{className:"songEditor-source",children:r.jsx($,{editorContent:t.content,updateFile:n,selectedFileId:t.id})})}),r.jsx(Se,{group:"a",children:r.jsx("div",{className:o.join(" "),children:r.jsx(pt,{selectedFile:t})})})]})})]})}mt.propTypes={selectedFile:i.object,theme:i.string.isRequired,updateFile:i.func.isRequired};const as=T(e=>({theme:p(e,"editorPreferences","theme")}))(mt);function ht(e){const{selectedFile:t}=e,n=C.createRef(),s=o=>{(o.metaKey||o.ctrlKey)&&o.key.toLowerCase()==="a"&&(o.preventDefault(),window.getSelection().selectAllChildren(n.current))};return R.useEffect(()=>(window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)})),r.jsx("div",{className:"exportPreview exp-SongRenderer",ref:n,children:r.jsx(ge,{content:t.content,useChartFormat:!0})})}ht.propTypes={selectedFile:i.object.isRequired};function gt(e){const{theme:t,selectedFile:n,fontSize:s,columnsCount:o}=e,a=["playRendererWrapper1"];a.push("cmTheme-"+t),a.push("cmSong--fontSize"+s);const l=["playRenderer"];return l.push("playRenderer--columns-"+o),r.jsx("div",{className:a.join(" "),"data-testid":"playRendererWrapper1",children:r.jsx("div",{className:"playRendererWrapper2",children:r.jsx("div",{className:l.join(" "),"data-testid":"playRenderer",children:r.jsx(ge,{content:n.content})})})})}gt.propTypes={theme:i.string.isRequired,fontSize:i.number.isRequired,selectedFile:i.object.isRequired,columnsCount:i.number.isRequired};const ls=T(e=>({theme:p(e,"editorPreferences","theme"),fontSize:p(e,"songFormatting","fontSize"),columnsCount:p(e,"songFormatting","columnsCount")}))(gt);function fe(e){const{pageHeader:t,allColumnsLines:n,documentSize:s,documentMargins:o,fontSize:a}=e,l=n.map((u,h)=>{const m=u.join("");return r.jsx("div",{className:"printPreview-pageColumn","data-testid":"printPreview-pageColumn",dangerouslySetInnerHTML:{__html:ut(m)}},h)}),c=["printPreview-page"];c.push("printPreview-page--"+s),c.push("cmSong--fontSize"+a),c.push("cmSong");const d=["printPreview-pageContentWrapper"];return d.push("printPreview-pageContentWrapper--padding"+o),r.jsx("div",{className:c.join(" "),"data-testid":"printPreview-page",children:r.jsx("div",{className:d.join(" "),"data-testid":"printPreview-pageContentWrapper",children:r.jsxs("div",{className:"printPreview-pageContent",children:[t,r.jsx("div",{className:"printPreview-pageColumnWrapper",children:l})]})})})}fe.defaultProps={allColumnsLines:[]};fe.propTypes={pageHeader:i.element,allColumnsLines:i.arrayOf(i.arrayOf(i.string)),documentSize:i.string.isRequired,documentMargins:i.number.isRequired,fontSize:i.number.isRequired};const ye=C.memo(fe);function be(e){const{title:t}=e;return r.jsx("div",{className:"printPreview-pageHeader",children:t})}be.defaultProps={allColumnsLines:[]};be.propTypes={title:i.string.isRequired};const ft=C.memo(be),xe={emptyLine:"cmEmptyLine",chordLine:"cmChordLine",textLine:"cmLyricLine"};function cs(e,{columnsCount:t,firstPageHeight:n,normalPageHeight:s,columnBreakOnSection:o,noEmptyLinesOnColumnStart:a=!0,noOrphanTextLine:l=!0}){const c=hs({columnsCount:t,firstPageHeight:n,normalPageHeight:s,noEmptyLinesOnColumnStart:a});let d=[],u=0;return(n||s)>0&&e.forEach((m,f)=>{ds(c,m,d,a)&&(d.push(m),u+=m.height),d.length>0&&us(m,e[f+1],{noOrphanTextLine:l,columnBreakOnSection:o})&&(c.fitsOnCurrentColumn(u)?c.insert(d):c.fitsOnNextColumn(u)?c.insertOnNextColumn(d):c.insert(d),d=[],u=0)}),c.get()}function ds(e,t,n,s){return!(J(t)&&!e.fitsOnCurrentColumn(t.height)&&n.length===0&&s===!0)}function us(e,t,{noOrphanTextLine:n,columnBreakOnSection:s}){if(J(e)||!t)return!0;const o=ps(e)&&ms(t);if(n===!0&&o)return!1;const a=J(t);return!(s===!0&&!a)}function J(e){return Ce(e.content,xe.emptyLine)}function ps(e){return Ce(e.content,xe.chordLine)}function ms(e){return Ce(e.content,xe.textLine)}function Ce(e,t){return e.indexOf(t)>-1}function hs({firstPageHeight:e,normalPageHeight:t,columnsCount:n}){const s=[];let o=0,a=0,l=u(),c=0;s[o]=[],s[o][a]=[];function d(g){g.forEach(y=>{h(c+y.height)&&m(),s[o][a].push(y.content),c+=y.height})}function u(){return o===0&&e?e:t}function h(g){return g>l}function m(){f()?(o++,s[o]=[],a=0):a++,s[o][a]=[],c=0,l=u()}function f(){return a===n-1}return{insert(g){d(g)},insertOnNextColumn(g){m(),d(g)},fitsOnCurrentColumn(g){return c+g<=l},fitsOnNextColumn(g){const y=o===0&&a<n&&e?e:t;return g<=y},get(){return s}}}function yt(e,t){const n=document.createElement("div");n.classList.add("measuring-node"),document.body.appendChild(n);const s=Me(n);return new Promise(o=>{const a=()=>(R.useLayoutEffect(()=>{const l=t(n);o(l)}),r.jsx("div",{children:e}));s.render(r.jsx(a,{}))}).then(o=>(s.unmount(),n.parentNode.removeChild(n),o))}function je(e,t=[]){for(let n=t.length||0;n<e;n++)t.push([]);return t}function gs(e){return e.offsetHeight}function Pe(e){return e.clientHeight}const fs={line:".cmLine"};async function ys(e,{columnsCount:t,documentSize:n,documentMargins:s,fontSize:o}){const a=r.jsx("div",{className:"printPreview cmTheme-print",children:r.jsx(ye,{allColumnsLines:je(t,[e]),columnsCount:t,documentSize:n,documentMargins:s,fontSize:o})});return await yt(a,c=>{const d=[];return c.querySelectorAll(fs.line).forEach(u=>{d.push(gs(u))}),d})}async function bs(e,{columnsCount:t,documentSize:n,documentMargins:s,fontSize:o}){const a=r.jsx(ye,{pageHeader:r.jsx(ft,{title:e}),allColumnsLines:je(t),documentSize:n,documentMargins:s,fontSize:o});return await yt(a,c=>{const d=c.querySelector(".printPreview-pageContent"),u=c.querySelector(".printPreview-pageColumnWrapper");return{firstPageHeight:Pe(u),normalPageHeight:Pe(d)}})}function bt(e){const[t,n]=R.useState([]),{title:s,allLines:o,columnsCount:a,columnBreakOnSection:l,documentSize:c,documentMargins:d,fontSize:u}=e;R.useLayoutEffect(()=>{(async()=>{const f={columnsCount:a,documentSize:c,documentMargins:d,fontSize:u},g=await ys(o,f),{normalPageHeight:y,firstPageHeight:w}=await bs(s,f),N=o.map((j,b)=>({content:j,height:g[b]})),F=cs(N,{columnsCount:a,columnBreakOnSection:l,normalPageHeight:y,firstPageHeight:w});n(F)})()},[o,s,a,l,c,d,u]);const h=t.map((m,f)=>r.jsx(ye,{pageHeader:f===0?r.jsx(ft,{title:s}):null,allColumnsLines:je(a,m),documentSize:c,documentMargins:d,fontSize:u},f));return r.jsx(C.Fragment,{children:h})}bt.propTypes={title:i.string.isRequired,allLines:i.arrayOf(i.string).isRequired,columnsCount:i.number.isRequired,columnBreakOnSection:i.bool.isRequired,documentSize:i.string.isRequired,documentMargins:i.number.isRequired,fontSize:i.number.isRequired};function xt(e){const{selectedFile:t}=e,n=k(e,["transposeValue","accidentalsType","symbolType","chartType","alignChordsWithLyrics","alignBars","autoRepeatChords","expandSectionCopy"]),o=rt(t.content||"",{...n}).match(/(<p.*?>.*?<\/p>)/gm),a=["printPreview","cmTheme-print"];return r.jsx("div",{className:a.join(" "),"data-testid":"printPreview",children:r.jsx(bt,{title:t.title||"",allLines:o,columnsCount:e.columnsCount,columnBreakOnSection:e.columnBreakOnSection,documentSize:e.documentSize||"a4",documentMargins:e.documentMargins,fontSize:e.fontSize})})}xt.propTypes={chartType:i.string.isRequired,selectedFile:i.object.isRequired,columnsCount:i.number.isRequired,columnBreakOnSection:i.bool.isRequired,documentSize:i.string,documentMargins:i.number.isRequired,fontSize:i.number.isRequired};const xs=T(e=>({accidentalsType:p(e,"songPreferences","preferredAccidentals"),transposeValue:p(e,"songPreferences","transposeValue"),symbolType:p(e,"songPreferences","symbolType"),chartType:p(e,"songFormatting","chartType"),alignChordsWithLyrics:p(e,"songFormatting","alignChordsWithLyrics"),alignBars:p(e,"songFormatting","alignBars"),autoRepeatChords:p(e,"songFormatting","autoRepeatChords"),expandSectionCopy:p(e,"songFormatting","expandSectionCopy"),columnsCount:p(e,"songFormatting","columnsCount"),columnBreakOnSection:p(e,"songFormatting","columnBreakOnSection"),documentMargins:p(e,"songFormatting","documentMargins"),fontSize:p(e,"songFormatting","fontSize")}))(xt);function Ct(e){const{editorMode:t}=e;switch(t){case"edit":return r.jsx(as,{...e});case"play":return r.jsx(ls,{...e});case"print":return r.jsx(xs,{...e});case"export":return r.jsx(ht,{...e})}}Ct.propTypes={editorMode:i.string.isRequired};const Cs=T(e=>({selectedFile:te(e,S(e))||{},editorMode:P(e)}),{updateFile:Ve})(Ct);function jt(e){const{id:t,allWidgets:n,nonInteractableWidgets:s,hiddenWidgets:o,setOption:a,getEntryComponent:l}=e,c=["optionsPanel","optionsPanel-"+t];let d,u,h,m,f,g,y;const w=n.widgetsOrder.filter(F=>!o.includes(F)).map(F=>(d=n.allWidgets[F],d.type==="optionsGroup"?(y=d.groupWidgetsOrder.filter(j=>!o.includes(j)).map(j=>(u=d.allGroupWidgets[j],g=!s.includes(F)&&!s.includes(j),N(j,u,g))),y.length===0?null:(m=l(d.type),f=!s.includes(F),r.jsx(m,{isInteractable:f,label:d.label,icon:d.icon,children:y},F))):N(F,d,!s.includes(F))));function N(F,j,b){return h=l(j.type),r.jsx(h,{isInteractable:b,optionContext:j.option.context,optionKey:j.option.key,optionValue:e[j.option.key],setOption:a,label:j.label,...j.typeOptions},F)}return r.jsx("div",{className:c.join(" "),children:w})}jt.propTypes={id:i.string.isRequired,allWidgets:i.object.isRequired,nonInteractableWidgets:i.arrayOf(i.string).isRequired,hiddenWidgets:i.arrayOf(i.string).isRequired,setOption:i.func.isRequired,getEntryComponent:i.func.isRequired};function Re(e){const{isInteractable:t,icon:n,label:s}=e,o=["sb-optionsGroup"];a()||o.push("sb-optionsGroup-isNotInteractable");function a(){return t&&e.children&&e.children.length>0}return r.jsxs("div",{className:o.join(" "),children:[r.jsxs("div",{className:"sb-optionsGroup-title",children:[r.jsx("span",{className:"sb-optionsGroup-iconTitle",children:r.jsx(x,{iconName:n})})," ",s]}),r.jsx("div",{className:"sb-optionsGroup-content",children:e.children})]})}Re.propTypes={isInteractable:i.bool.isRequired,icon:i.string.isRequired,label:i.string.isRequired,children:i.arrayOf(i.element)};Re.defaultProps={};function Rt(e){const{isSelected:t,isInteractable:n,label:s,onClick:o}=e;let a;const l=["sb-optionSelectChoice"];t&&(l.push("sb-optionSelectChoice-isSelected"),a=r.jsx("span",{className:"sb-optionSelectChoice-checkIcon",children:r.jsx(x,{iconName:"check"})})),n||l.push("sb-optionSelectChoice-isNotInteractable");function c(){n&&o()}return r.jsxs("div",{className:l.join(" "),onClick:c,children:[r.jsx("div",{className:"sb-optionSelectChoice-check",children:t&&a}),r.jsx("div",{className:"sb-optionSelectChoice-label",children:s})]})}Rt.propTypes={isSelected:i.bool.isRequired,isInteractable:i.bool.isRequired,label:i.string.isRequired,onClick:i.func.isRequired};const js=C.memo(Rt);function vt(e){const[t,n]=R.useState(!1),{isInteractable:s,label:o,allChoices:a,optionContext:l,optionKey:c,optionValue:d,setOption:u}=e,h=["sb-optionSelect"];s||h.push("sb-optionSelect-isNotInteractable");const m=t?"keyboard_arrow_down":"keyboard_arrow_right";function f(){n(!t)}const g=t?r.jsx("div",{className:"sb-optionSelect-choices",children:a.map(N=>r.jsx(js,{label:N.label,isSelected:d===N.value,isInteractable:s,onClick:()=>{u(l,c,N.value)}},N.value))}):null,y=a.find(N=>d===N.value).label,w=t?o:r.jsxs("span",{children:[r.jsx("span",{children:o+": "}),r.jsx("span",{className:"sb-optionSelectChoice-activeLabel",children:y})]});return r.jsxs("div",{className:h.join(" "),children:[r.jsxs("div",{className:"sb-optionSelect-title",onClick:s?f:null,children:[r.jsx("div",{className:"sb-optionSelect-desc","data-testid":"selectLabel",children:w}),r.jsx("div",{className:"sb-optionSelect-toggle",children:r.jsx("span",{className:"sb-optionSelect-icon",children:r.jsx(x,{iconName:m})})})]}),g]})}vt.propTypes={isInteractable:i.bool.isRequired,label:i.string.isRequired,allChoices:i.array.isRequired,optionContext:i.string.isRequired,optionKey:i.string.isRequired,optionValue:i.string.isRequired,setOption:i.func.isRequired};function ve(e){const{isInteractable:t,label:n,min:s,max:o,showPlusSymbol:a,optionContext:l,optionKey:c,optionValue:d,setOption:u}=e,h=["sb-optionSlider"];t||h.push("sb-optionSlider-isNotInteractable");function m(g){u(l,c,Number.parseInt(g.target.value))}const f=d>0&&a?"+"+d:d;return r.jsxs("div",{className:h.join(" "),children:[r.jsx("div",{className:"sb-optionSlider-desc",children:n}),r.jsx("div",{className:"sb-optionSlider-value",children:f}),r.jsx("div",{className:"sb-optionSlider-range",children:r.jsx("input",{min:s,max:o,value:d,type:"range",onChange:t?m:null,disabled:!t})})]})}ve.propTypes={isInteractable:i.bool.isRequired,label:i.string.isRequired,min:i.number.isRequired,max:i.number.isRequired,showPlusSymbol:i.bool,optionContext:i.string.isRequired,optionKey:i.string.isRequired,optionValue:i.number.isRequired,setOption:i.func.isRequired};ve.defaultProps={showPlusSymbol:!0};const Rs=C.memo(ve);function Ft(e){const{isInteractable:t,label:n,optionContext:s,optionKey:o,optionValue:a,setOption:l}=e,c=["sb-optionToggle"];c.push(a===!0?"sb-optionToggle-isOn":"sb-optionToggle-isOff"),t||c.push("sb-optionToggle-isNotInteractable");function d(){l(s,o,!a)}return r.jsxs("div",{className:c.join(" "),onClick:t?d:null,children:[r.jsx("div",{className:"sb-optionToggle-desc",children:n}),r.jsx("div",{className:"sb-optionToggle-icon",children:r.jsx("span",{className:"sb-optionToggle-icon",children:r.jsx(x,{iconName:a===!0?"toggle_on":"toggle_off"})})})]})}Ft.propTypes={isInteractable:i.bool.isRequired,label:i.string.isRequired,optionContext:i.string.isRequired,optionKey:i.string.isRequired,optionValue:i.bool.isRequired,setOption:i.func.isRequired};const vs=C.memo(Ft);function Fs(e){switch(e){case"optionsGroup":return Re;case"select":return vt;case"slider":return Rs;case"toggle":return vs}}function Ns(e){return r.jsx("div",{className:"sb-optionsPanel",children:r.jsx(jt,{...e,getEntryComponent:Fs})})}function Ts(e){return r.jsxs("div",{className:"renderingOptionsPanel",children:[r.jsx("div",{className:"renderingOptionsPanel-isCollapsed",children:r.jsx("span",{className:"renderingOptionsPanel-icon",children:r.jsx(x,{iconName:"settings"})})}),r.jsx("div",{className:"renderingOptionsPanel-isExpanded",children:r.jsx(Ns,{...e,id:"rendering"})})]})}const Ss=(e,t,n)=>{if(!e)throw new TypeError("Cannot set an option without a context");if(!t)throw new TypeError("Cannot set an option without a key");return v(Z,{context:e,key:t,value:n})};function ws(e,t,n,s){return T(o=>{const a={allWidgets:e,nonInteractableWidgets:t(o),hiddenWidgets:n(o)};let l,c;return e.widgetsOrder.forEach(d=>{l=e.allWidgets[d],l.groupWidgetsOrder.forEach(u=>{c=l.allGroupWidgets[u],a[c.option.key]=p(o,c.option.context,c.option.key)})}),a},{setOption:Ss})(s)}const _s={widgetsOrder:["editorPreferences","key","preferences","layout"],allWidgets:{editorPreferences:{label:"Editor preferences",type:"optionsGroup",icon:"tune",groupWidgetsOrder:["theme","chartFormat"],allGroupWidgets:{theme:{label:"Theme",type:"select",typeOptions:{allChoices:[{id:"themeDark1",label:"Dark 1 (default)",value:"dark1"},{id:"themeDark2",label:"Dark 2",value:"dark2"},{id:"themeDark3",label:"Dark 3",value:"dark3"}]},option:{context:"editorPreferences",key:"theme"}},chartFormat:{label:"Export format",type:"select",typeOptions:{allChoices:[{id:"formatChordMark",label:"ChordMark",value:"chordmark"},{id:"formatChordMarkSrc",label:"ChordMark (Source)",value:"chordmarkSrc"},{id:"formatChordpro",label:"ChordPro",value:"chordpro"},{id:"formatUG",label:"UltimateGuitar",value:"ultimateGuitar"}]},option:{context:"editorPreferences",key:"chartFormat"}}}},key:{label:"Key",type:"optionsGroup",icon:"music_note",groupWidgetsOrder:["transposeValue","preferredAccidentals","symbolType"],allGroupWidgets:{transposeValue:{label:"Transpose",type:"slider",typeOptions:{min:-11,max:11,showPlusSymbol:!0},option:{context:"songPreferences",key:"transposeValue"}},preferredAccidentals:{label:"Preferred accidentals",type:"select",typeOptions:{allChoices:[{id:"preferredAccidentalsAuto",label:"Auto",value:"auto"},{id:"preferredAccidentalsSharp",label:"♯",value:"sharp"},{id:"preferredAccidentalsFlat",label:"♭",value:"flat"}]},option:{context:"songPreferences",key:"preferredAccidentals"}},symbolType:{label:"Symbols type",type:"select",typeOptions:{allChoices:[{id:"symbolTypeChord",label:"Chord symbols",value:"chord"},{id:"symbolTypeRoman",label:"Roman numerals",value:"roman"}]},option:{context:"songPreferences",key:"symbolType"}}}},preferences:{label:"Chart settings",type:"optionsGroup",icon:"tune",groupWidgetsOrder:["chartType","alignChordsWithLyrics","alignBars","autoRepeatChords","expandSectionCopy"],allGroupWidgets:{chartType:{label:"Type",type:"select",typeOptions:{allChoices:[{id:"typedisplayAll",label:"Show everything",value:"all"},{id:"typedisplayLyrics",label:"Lyrics only",value:"lyrics"},{id:"typedisplayChords",label:"Chords only",value:"chords"},{id:"typedisplayChordsFirstLyricLine",label:"Chords + First lyric line",value:"chordsFirstLyricLine"}]},option:{context:"songFormatting",key:"chartType"}},alignChordsWithLyrics:{label:"Align chords with lyrics",type:"toggle",option:{context:"songFormatting",key:"alignChordsWithLyrics"}},alignBars:{label:"Align bars",type:"toggle",option:{context:"songFormatting",key:"alignBars"}},autoRepeatChords:{label:"Auto repeat chords",type:"toggle",option:{context:"songFormatting",key:"autoRepeatChords"}},expandSectionCopy:{label:"Expand copied sections",type:"toggle",option:{context:"songFormatting",key:"expandSectionCopy"}}}},layout:{type:"optionsGroup",label:"Layout",icon:"view_compact",groupWidgetsOrder:["fontSize","columnsCount","columnBreakOnSection","documentMargins"],allGroupWidgets:{fontSize:{label:"Font size",type:"slider",typeOptions:{min:-5,max:5,showPlusSymbol:!0},option:{context:"songFormatting",key:"fontSize"}},columnsCount:{label:"Columns",type:"slider",typeOptions:{min:1,max:4},option:{context:"songFormatting",key:"columnsCount"}},columnBreakOnSection:{label:"Column Break on section",type:"toggle",option:{context:"songFormatting",key:"columnBreakOnSection"}},documentMargins:{label:"Margins",type:"slider",typeOptions:{min:1,max:5},option:{context:"songFormatting",key:"documentMargins"}}}}}},Es=e=>{const t=[],n=p(e,"songFormatting","chartType");n==="lyrics"?(t.push("alignChordsWithLyrics"),t.push("alignBars"),t.push("autoRepeatChords")):n==="chords"&&t.push("alignChordsWithLyrics");const s=p(e,"editorPreferences","chartFormat");return P(e)==="export"&&s==="chordmarkSrc"&&(t.push("chartType"),t.push("alignChordsWithLyrics"),t.push("alignBars"),t.push("autoRepeatChords"),t.push("expandSectionCopy")),t},Ps=e=>{const t=[],n=Object.keys({...I(e,"editorPreferences"),...I(e,"songFormatting"),...I(e,"songPreferences")});if(!S(e))return n;const o=P(e),a=rn(n,re[o]);return t.push(...a),t},qs=ws(_s,Es,Ps,Ts);function Is(){const e=r.jsx(Zr,{}),t=r.jsx(qs,{});return r.jsx(Vr,{leftBar:e,rightBar:t,children:r.jsx(Cs,{})})}const Ms=[{name:"home",path:"",action:Is},...gr,...yr];Un();function Os(){Bn(),Zn();const e=window?window.location.pathname+window.location.search:"/";return rr.init(Ms),H(e)}Os();
